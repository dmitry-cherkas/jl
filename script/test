#!/bin/sh
set -e
cd "$(dirname "$0")/.."

go mod verify
go test ./...

GO111MODULE=on go get github.com/golangci/golangci-lint/cmd/golangci-lint@v1.17.1
"$(go env GOPATH)/bin/golangci-lint" run ./...

go install
(
  cd examples
  export JL_OPTS="--no-color"
  PATH="$(go env GOPATH)/bin:${PATH}:$(pwd)/mocks"
  export PATH
  cram -E --verbose --indent=4 ../README.md ./*.md
)
